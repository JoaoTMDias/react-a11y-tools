import { useState } from "react";
import { Meta, Story, Canvas, Preview, ArgsTable, Subtitle } from "@storybook/addon-docs/blocks";
import { RouteAnnouncer } from "./index";
import { Router, Link, useLocation, createMemorySource, createHistory, LocationProvider } from "@reach/router";

<Meta title="Components/Announcer" component={RouteAnnouncer} />

export let history = createHistory(window);

export const Home = () => (
	<div>
		<h1>Welcome</h1>
		<p>You are on the welcome page</p>
		<nav
			style={{
				display: "flex",
				flexDirection: "column",
				gap: "1rem",
			}}
		>
			<Link to="/dashboard">Dashboard</Link>
			<Link to="/invoices/123">Invoice 123</Link>
			<Link to="/invoices/abc">Invoice ABC</Link>
		</nav>
	</div>
);

export const Dashboard = () => (
	<div>
		<h1>Dashboard</h1>
		<p>You are on the dashboard page</p>
		<nav
			style={{
				display: "flex",
				flexDirection: "column",
				gap: "1rem",
			}}
		>
			<Link to="/">Home</Link>
			<Link to="/invoices/123">Invoice 123</Link>
			<Link to="/invoices/abc">Invoice ABC</Link>
		</nav>
	</div>
);

export const Invoice = (props) => (
	<div>
		<h1>Invoice {props.invoiceId}</h1>
		<p>You are on the invoice page</p>
		<nav
			style={{
				display: "flex",
				flexDirection: "column",
				gap: "1rem",
			}}
		>
			<Link to="/">Home</Link>
			<Link to="/dashboard">Dashboard</Link>
		</nav>
	</div>
);

export const DemoWithRouter = () => {
	return (
		<LocationProvider history={history}>
			{(context) => {
				return (
					<RouteAnnouncer pathname={context.location.pathname}>
						<Link to="/">Home</Link>
						<Router>
							<Home path="/" />
							<Dashboard path="/dashboard" />
							<Invoice path="/invoices/:invoiceId" />
						</Router>
					</RouteAnnouncer>
				);
			}}
		</LocationProvider>
	);
};

# Route Announcer

<Subtitle>
	<code>Flex</code> is a flexbox helper component and comes with helpful style shorthand. It renders a div element, but
	can render another type of <code>HTMLElement</code> using the prop <code>as</code>.
</Subtitle>

## Usage

Using the Flex components, here are some helpful shorthand props:

- `flexDirection` is `direction`.
- `flexWrap` is `wrap`.
- `flexBasis` is `basis`.
- `flexGrow` is `grow`.
- `flexShrink` is `shrink`.
- `alignItems` is `align`.
- `justifyContent` is `justify`.
- `gap` is `gap` (with fallback for older browsers).

While you can write the CSS styles, using this helper can save you some time.

<Canvas>
	<Story
		name="RouteAnnouncer"
		args={{
			pathname: window.location.pathname,
		}}
	>
		{() => <DemoWithRouter />}
	</Story>
</Canvas>

### Props

<ArgsTable story="RouteAnnouncer" />
