import { Meta, Story, Canvas, Preview, ArgsTable, Subtitle } from "@storybook/addon-docs/blocks";
import { useRef, useState } from "react";
import { action } from "@storybook/addon-actions";
import { FocusTrap } from "../src/components/focus-trap/index";

<Meta title="Components/Focus Trap" component={FocusTrap} />

<style>{`
	.popover {
		font-family: sans-serif;
		position: fixed;
		z-index: 15;
		width: 100%;
		max-width: 25rem;
		height: 100%;
		top: 0;
		right: 0;
		visibility: visible;
	}

	.popover__wrapper {
		position: absolute;
		width: 100%;
		height: 100%;
		top: 0;
		right: 0;
		background-color: white;
		box-shadow: 0 0.9px 1.5px rgba(0, 0, 0, 0.03),
                  0 3.1px 5.5px rgba(0, 0, 0, 0.08),
                  0 14px 25px rgba(0, 0, 0, 0.12);
	}

	.popover__body {
		margin: 0;
		padding: 0;
		border: 0;
		display: flex;
		flex-direction: column;
		height: 100%;
		overflow-y: auto;
		overflow-x: hidden;
		overscroll-behavior: contain;
	}

	.popover__header {
		width: 100%;
		height: 4.5rem;
		display: flex;
		flex-direction: row;
		justify-content: flex-start;
		align-items: center;
	}

	.popover__header__title {
		width: 100%;
		color: #1c1c21;
		line-height: 1.2;
		font-size: 1.2rem;
		font-weight: 700;
		padding: 0 2rem;
		margin: 0;
	}

	.popover__header__button {
		margin-right: 2rem;
	}

	.popover__content {
		padding: 2rem;
	}

	.popover__content__list {
		margin: 0;
		padding: 0;
		list-style-type: none;
	}

	.popover__content__list li {
		width: 100%;
		height: 2rem;
		display: flex;
		flex-direction: row;
		justify-content: flex-start;
		align-items: center;
	}

	.popover__link {
		width: 100%;
		height: 100%;
		display: flex;
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		color: #1c1c21;
		text-decoration: none;
		font-size: 1.125rem;
	}

	.popover__link:hover,
	.popover__link:focus {
		width: 100%;
		text-decoration: underline;
	}

	.popover__link:focus {
		outline: 1px solid tomato;
		outline-offset: 2px;
	}

	.popover__footer {
		margin-top: calc(100% + 4.5rem);
		height: 4.5rem;
		width: 100%;
	}

	.popover__footer__wrapper {
		padding: 2rem;
		position: relative;
		display: flex;
		flex-direction: row;
		justify-content: center;
		align-items: center;
	}

	.popover__footer__input {
		margin: 0;
		color: inherit;
		appearance: none;
		font-size: 1em;
		padding-top: 0.5em;
		padding-bottom: 0.5em;
		padding-left: 0.75em;
		padding-right: 2.5rem;
		border-radius: 0.25em;
		line-height: 1.2;
		background-color: white;
		border: 2px solid #d3d3d4;
		transition: 0.2s;
		width: 100%;
		height: 2.5rem;
	}

	.popover__footer__icon {
		background-color: transparent;
		padding: 0;
		border: 0;
		border-radius: 0;
		color: inherit;
		line-height: inherit;
		appearance: none;
		position: absolute;
		right: 2.5rem;
		display: flex;
		justify-content: center;
		align-items: center;
		width: 2.5rem;
		height: 2.5rem;
	}

	.popover__footer__icon .icon {
		fill: currentColor;
		line-height: 1;
		flex-shrink: 0;
		max-width: initial;
		display: block;
		width: 1.5rem;
		height: 1.5rem;
		margin-left: auto;
		margin-right: auto;
		color: #79797c;
		transition: .2s;
	}
`}</style>

export const Demo = (props) => {
	const [isVisible, setIsVisible] = useState(false);
	return (
		<div>
			<button type="button" onClick={() => setIsVisible(true)}>
				Show Menu
			</button>
			{isVisible && (
				<FocusTrap {...props}>
					<div className="popover" id="dr-nav-id" tabIndex={-1}>
						<div className="popover__wrapper" role="alertdialog" aria-labelledby="popover-title">
							<div className="popover__body">
								<header className="popover__header">
									<h4 className="popover__header__title" id="popover-title">
										Menu
									</h4>
									<button type="button" className="popover__header__button" onClick={() => setIsVisible(false)}>
										Close
									</button>
								</header>
								<nav className="popover__content" aria-label="Main">
									<ul className="popover__content__list">
										<li>
											<a className="popover__link" href="#0">
												<span>Home</span>
												<span>35</span>
											</a>
										</li>
										<li>
											<a className="popover__link" href="#0">
												<span>Trending</span>
												<span>17</span>
											</a>
										</li>
										<li>
											<a className="popover__link" href="#0">
												<span>Subscriptions</span>
												<span>12</span>
											</a>
										</li>
										<li>
											<a className="popover__link" href="#0">
												<span>Library</span>
												<span>24</span>
											</a>
										</li>
										<li>
											<a className="popover__link" href="#0">
												<span>History</span>
												<span>18</span>
											</a>
										</li>
									</ul>
								</nav>
								<footer className="popover__footer">
									<div className="popover__footer__wrapper">
										<input
											className="popover__footer__input"
											type="search"
											placeholder="Search..."
											aria-label="Search"
										/>
										<button className="popover__footer__icon">
											<svg className="icon" viewBox="0 0 24 24">
												<g
													fill="none"
													stroke="currentColor"
													strokeLinecap="square"
													strokeLinejoin="miter"
													strokeMiterlimit="10"
													strokeWidth="2"
												>
													<path d="M22 22L15.656 15.656" />
													<circle cx="10" cy="10" r="8" />
												</g>
											</svg>
										</button>
									</div>
								</footer>
							</div>
						</div>
					</div>
				</FocusTrap>
			)}
		</div>
	);
};

# Focus Trap

<Subtitle>Trap focus within a DOM node</Subtitle>

## Usage

text here

<Canvas>
	<Story
		name="Focus Trap"
		args={{
			contain: true,
			autoFocus: true,
			restoreFocus: true,
		}}
	>
		{(args) => <Demo {...args} />}
	</Story>
</Canvas>

### Props

<ArgsTable story="Focus Trap" />
